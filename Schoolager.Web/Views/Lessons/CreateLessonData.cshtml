@using Newtonsoft.Json
@model Schoolager.Web.Models.Lessons.LessonDataViewModel
@{
    ViewData["Title"] = "CreateLessonData";
}

<div class="container-fluid p-5">
    <div class="bg-white">
        <div class="px-3 p-3 d-flex justify-content-between align-items-center">

            <a asp-action="Index" class="btn btn-outline-secondary">Back</a>
            <h2>New Lesson</h2>
        </div>
        <div class="d-flex justify-content-center align-items-center w-100">
            <form>
                <div class="mb-2">
                    <label asp-for="Summary" class="control-label">Summary</label>
                    <textarea asp-for="Summary"class="form-control"></textarea>
                    <span asp-validation-for="Summary" class="text-secondary"></span>
                </div>
                <div class="mb-2">
                    <table class="table table-bordered table-hover" id="tableAll">
                        <thead>
                            <tr>
                                <th>Selected</th>
                                <th>Nome</th>
                                <th>Date of Birth</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach(var student in Model.Students)
                            {
                                <tr data-student="@JsonConvert.SerializeObject(student)">
                                    <td class="align-middle"><input type="checkbox" name="addSelected" /></td>
                                    <td class="align-middle">@student.FullName</td>
                                    <td class="align-middle">@student.DateOfBirth.Value.ToShortDateString()</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </form>
        </div>
    </div>
</div>


@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script type="text/javascript">
        $(document).ready(function() {
            $("#treatmentsNav").addClass("active");
            $("#treatmentsNav").addClass("bg-dark");

            let id = 0;

            // Delete
            $("a[id*=btnDeleteSpeciality]").click(function() {
                id = $(this).parent()[0].id;
                console.log($(this).parent()[0].id);
                $("#deleteDialog").modal("show");
                return false;
            });

            $("#btnNoDelete").click(function() {
                $("#deleteDialog").modal("hide");
                return false;
            });

            $("#btnYesDelete").click(function() {
                window.location.href = "/Treatments/Delete/" + id;
            });

            // Datatable
            let table = $("#treatmentsTable").DataTable({
                columnDefs: [ {
                    targets: 2,
                    render: $.fn.dataTable.render.ellipsis( 190, true )
                } ],
                lengthChange: false,
                pageLength: 20,
            } );

            $('#treatmentsTable tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                } else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
            });
        });
    </script>
}